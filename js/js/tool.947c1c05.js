(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["js/tool"],{"02f4":function(t,e,s){var a=s("4588"),i=s("be13");t.exports=function(t){return function(e,s){var r,n,o=String(i(e)),l=a(s),c=o.length;return l<0||l>=c?t?"":void 0:(r=o.charCodeAt(l),r<55296||r>56319||l+1===c||(n=o.charCodeAt(l+1))<56320||n>57343?t?o.charAt(l):r:t?o.slice(l,l+2):n-56320+(r-55296<<10)+65536)}}},"5df3":function(t,e,s){"use strict";var a=s("02f4")(!0);s("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,s=this._i;return s>=e.length?{value:void 0,done:!0}:(t=a(e,s),this._i+=t.length,{value:t,done:!1})})},a6c3:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"dashboard-content"},[s("div",{staticClass:"form-section"},[s("div",{staticClass:"section-title"},[t._v("发货关联运单号")]),s("div",{staticClass:"mt-m"},[s("span",{staticClass:"label",attrs:{type:"text"}},[t._v("1. 上传快递发货表: ")]),s("el-button",{attrs:{size:"small"},on:{click:function(e){t.$refs.uploadSource.click()}}},[t._v("选择文件")]),t.source?s("span",{staticClass:"remark"},[t._v(t._s(t.source.name))]):t._e()],1),s("div",{staticClass:"mt-m"},[s("span",{staticClass:"label",attrs:{type:"text"}},[t._v("2. 上传枫页订单表: ")]),s("el-button",{attrs:{size:"small"},on:{click:function(e){t.$refs.uploadTarget.click()}}},[t._v("选择文件")]),t.target?s("span",{staticClass:"remark"},[t._v(t._s(t.target.name))]):t._e()],1),s("div",{staticClass:"mt-m"},[s("span",{staticClass:"label",attrs:{type:"text"}},[t._v("3. 选择快递公司: ")]),s("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceOption,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),s("div",{staticClass:"mt-l"},[s("el-button",{attrs:{size:"small",type:"primary",disabled:t.disabled},on:{click:t.mergeFile}},[t._v("确认合并")]),s("span",{staticClass:"remark"},[t._v("在发货表里找不到运单号的订单，快递公司会变成未知，快递单号会变成空")])],1)]),s("input",{ref:"uploadSource",attrs:{type:"file"},on:{change:t.chooseSource}}),s("input",{ref:"uploadTarget",attrs:{type:"file"},on:{change:t.chooseTarget}})])},i=[],r=(s("ac6a"),s("5df3"),s("20d6"),s("1146")),n=s.n(r),o={name:"Tool",data:function(){return{sourceType:"debang",sourceOption:[{label:"德邦物流",value:"debang"},{label:"韵达快递",value:"yunda"}],source:null,target:null,sourceList:[],targetList:[]}},computed:{disabled:function(){return!this.source||!this.target},sourceName:function(){var t=this,e=this.sourceOption.findIndex(function(e){return e.value===t.sourceType});return this.sourceOption[e].label}},methods:{chooseSource:function(t){this.source=t.target.files?t.target.files[0]:null},chooseTarget:function(t){this.target=t.target.files?t.target.files[0]:null},encryptNubmer:function(t){return"debang"===this.sourceType?"".concat(t.substr(0,4),"*****").concat(t.substr(9)):t},readFile:function(t){var e=this;return new Promise(function(s){var a=new FileReader;a.onload=function(a){var i=n.a.read(a.target.result,{type:"binary",codepage:936,cellDates:!0,cellStyles:!0}),r=n.a.utils.sheet_to_json(i.Sheets[i.SheetNames[0]]);e["".concat(t,"List")]=r,s()},a.readAsBinaryString(e[t])})},mergeFile:function(){var t=this;Promise.all([this.readFile("source"),this.readFile("target")]).then(function(){t.targetList.forEach(function(e){var s=t.sourceList.findIndex(function(s){return"debang"===t.sourceType?s["收件人姓名"]===e["姓名"]&&s["收件人手机"]===t.encryptNubmer(e["手机号码"]):s["订单号"].trim()===e["订单ID"]});e["快递单号"]=-1!==s?"".concat(t.sourceList[s]["运单号"]):"",e["快递公司"]=-1!==s?t.sourceName:"未知"});var e=n.a.utils.json_to_sheet(t.targetList,{header:["订单ID","页面名称","套餐明细","数量","套餐单价","总价","姓名","手机号码","省","市","地区","收件地址","下单IP","下单时间","订单状态","快递公司","快递单号","留言","备注","详情页URL","广告id","广告名称","投放账户","身份证"]}),s=n.a.utils.book_new();n.a.utils.book_append_sheet(s,e,"Sheet1"),n.a.writeFile(s,"枫页关联运单号列表.xls")})}}},l=o,c=s("2877"),u=Object(c["a"])(l,a,i,!1,null,null,null);u.options.__file="tool.vue";e["default"]=u.exports},ac6a:function(t,e,s){for(var a=s("cadf"),i=s("0d58"),r=s("2aba"),n=s("7726"),o=s("32e9"),l=s("84f2"),c=s("2b4c"),u=c("iterator"),d=c("toStringTag"),f=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=i(p),g=0;g<h.length;g++){var v,m=h[g],L=p[m],b=n[m],S=b&&b.prototype;if(S&&(S[u]||o(S,u,f),S[d]||o(S,d,m),l[m]=f,L))for(v in a)S[v]||r(S,v,a[v],!0)}}}]);
//# sourceMappingURL=tool.947c1c05.js.map