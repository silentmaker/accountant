(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["js/index"],{"456d":function(t,e,a){var l=a("4bf8"),s=a("0d58");a("5eda")("keys",function(){return function(t){return s(l(t))}})},"5eda":function(t,e,a){var l=a("5ca1"),s=a("8378"),i=a("79e5");t.exports=function(t,e){var a=(s.Object||{})[t]||Object[t],r={};r[t]=e(a),l(l.S+l.F*i(function(){a(1)}),"Object",r)}},"7f7f":function(t,e,a){var l=a("86cc").f,s=Function.prototype,i=/^\s*function ([^ (]*)/,r="name";r in s||a("9e1e")&&l(s,r,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},9261:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"dashboard-content"},[a("div",{staticClass:"form-section"},[a("div",{staticClass:"section-title"},[t._v("更新订单")]),a("div",{staticClass:"mt-m"},[a("span",{staticClass:"label",attrs:{type:"text"}},[t._v("导入订单")]),a("el-button",{attrs:{size:"small"},on:{click:function(e){t.$refs.upload.click()}}},[t._v("选择文件")]),t.file?a("span",{staticClass:"remark"},[t._v(t._s(t.file.name))]):t._e()],1),a("div",{staticClass:"mt-m"},[a("el-button",{attrs:{size:"small",type:"primary",disabled:!t.file,loading:!t.isImported},on:{click:t.uploadFile}},[t._v("确认导入")]),a("span",{staticClass:"remark"},[t._v("新上传的订单如果以前上传过则以新上传的为准")])],1),a("input",{ref:"upload",attrs:{type:"file"},on:{change:t.chooseFile}})]),a("div",{staticClass:"form-section"},[a("div",{staticClass:"section-title mb-m"},[t._v("筛选订单")]),a("label",{staticClass:"filter-label"},[a("span",{staticClass:"label-content"},[t._v("订单ID")]),a("el-input",{model:{value:t.filter.id,callback:function(e){t.$set(t.filter,"id",e)},expression:"filter.id"}})],1),a("label",{staticClass:"filter-label"},[a("span",{staticClass:"label-content"},[t._v("下单时间")]),a("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.filter.date,callback:function(e){t.$set(t.filter,"date",e)},expression:"filter.date"}})],1),a("label",{staticClass:"filter-label"},[a("span",{staticClass:"label-content"},[t._v("姓名")]),a("el-input",{model:{value:t.filter.name,callback:function(e){t.$set(t.filter,"name",e)},expression:"filter.name"}})],1),a("label",{staticClass:"filter-label"},[a("span",{staticClass:"label-content"},[t._v("手机号码")]),a("el-input",{model:{value:t.filter.phone,callback:function(e){t.$set(t.filter,"phone",e)},expression:"filter.phone"}})],1),a("label",{staticClass:"filter-label"},[a("span",{staticClass:"label-content"},[t._v("订单状态")]),a("el-select",{attrs:{placeholder:""},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"待确认",value:"待确认"}}),a("el-option",{attrs:{label:"待发货",value:"待发货"}}),a("el-option",{attrs:{label:"已发货",value:"已发货"}}),a("el-option",{attrs:{label:"已签收",value:"已签收"}}),a("el-option",{attrs:{label:"已退货",value:"已退货"}})],1)],1),a("label",{staticClass:"filter-label"},[a("span",{staticClass:"label-content"},[t._v("快递公司")]),a("el-select",{attrs:{placeholder:""},model:{value:t.filter.express,callback:function(e){t.$set(t.filter,"express",e)},expression:"filter.express"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"德邦物流",value:"德邦物流"}}),a("el-option",{attrs:{label:"韵达快递",value:"韵达快递"}})],1)],1),a("div",{staticClass:"mt-m"},[a("el-button",{attrs:{size:"small",type:"primary",loading:!t.isLoaded},on:{click:t.loadData}},[t._v("筛选")]),a("el-button",{attrs:{size:"small"},on:{click:t.clearFilter}},[t._v("清空")]),a("span",{staticClass:"remark"},[t._v("共"+t._s(t.pagination.total)+"个订单")])],1)]),a("el-table",{attrs:{stripe:"",data:t.orders}},[a("el-table-column",{attrs:{fixed:"",width:160,prop:"订单ID",label:"订单ID"}}),a("el-table-column",{attrs:{prop:"订单状态",label:"订单状态"}}),a("el-table-column",{attrs:{width:400,prop:"套餐明细",label:"套餐明细"}}),a("el-table-column",{attrs:{prop:"姓名",label:"姓名"}}),a("el-table-column",{attrs:{width:120,prop:"手机号码",label:"手机号码"}}),a("el-table-column",{attrs:{prop:"总价",label:"总价"}}),a("el-table-column",{attrs:{width:160,prop:"下单时间",label:"下单时间"}}),a("el-table-column",{attrs:{prop:"省",label:"省"}}),a("el-table-column",{attrs:{prop:"市",label:"市"}}),a("el-table-column",{attrs:{prop:"快递公司",label:"快递公司"}}),a("el-table-column",{attrs:{width:140,prop:"快递单号",label:"快递单号"}}),a("el-table-column",{attrs:{prop:"投放账户",label:"投放账户"}}),a("el-table-column",{staticClass:"operates",attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看详情",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-view",type:"primary"},on:{click:function(a){t.showOrder(e.row)}}})],1),e.row["快递单号"]?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"标记订单",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-star-off",type:"warning"},on:{click:function(a){t.markOrder(e.row)}}})],1):t._e(),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除记录",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(a){t.deleteOrder(e.row)}}})],1)]}}])})],1),a("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.pagination.page,"page-sizes":[20,50,100],"page-size":t.pagination.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.changeSize,"current-change":t.changePage}}),a("el-dialog",{attrs:{title:"订单详情",visible:t.showDetail,width:"540px"},on:{"update:visible":function(e){t.showDetail=e}}},[a("el-table",{attrs:{height:400,data:t.orderDetail}},[a("el-table-column",{attrs:{width:"120",property:"key",label:"属性"}}),a("el-table-column",{attrs:{property:"value",label:"内容"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showDetail=!1}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"标记订单",visible:t.showMark,width:"600px"},on:{"update:visible":function(e){t.showMark=e}}},[a("div",{staticClass:"pt-m pb-m"},[a("el-switch",{attrs:{disabled:!t.isMarked,"active-text":"问题件"},on:{change:function(e){t.changeMark(e,"trouble")}},model:{value:t.markType.trouble,callback:function(e){t.$set(t.markType,"trouble",e)},expression:"markType.trouble"}}),a("span",{staticClass:"ml-l remark"},[t._v(t._s(t.markType.trouble?"已经":"尚未")+"收到问题反馈")])],1),a("div",{staticClass:"pt-m pb-m"},[a("el-switch",{attrs:{disabled:!t.isMarked,"active-text":"退件"},model:{value:t.markType.return,callback:function(e){t.$set(t.markType,"return",e)},expression:"markType.return"}}),a("span",{staticClass:"ml-l remark"},[t._v(t._s(t.markType.return?"已经":"尚未")+"收到退件")])],1),a("div",{staticClass:"pt-m pb-m"},[a("el-switch",{attrs:{disabled:!t.isMarked,"active-text":"返款件"},model:{value:t.markType.profit,callback:function(e){t.$set(t.markType,"profit",e)},expression:"markType.profit"}}),a("span",{staticClass:"ml-l remark"},[t._v(t._s(t.markType.profit?"已经":"尚未")+"收到返款")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showMark=!1}}},[t._v("确 定")])],1)])],1)},s=[],i=(a("ac6a"),a("456d"),a("7f7f"),a("1146")),r=a.n(i),n={name:"Index",data:function(){return{filter:{id:"",name:"",phone:"",date:"",status:"",express:""},pagination:{page:1,limit:20,total:0},file:null,orders:[],isMarked:!1,markType:{trouble:!1,return:!1,profit:!1},markTarget:null,showMark:!1,showDetail:!1,orderDetail:null,isLoaded:!0,isImported:!0}},mounted:function(){this.loadData()},methods:{clearFilter:function(){this.filter.id="",this.filter.name="",this.filter.phone="",this.filter.date="",this.filter.status="",this.filter.express="",this.loadData()},changeSize:function(t){this.pagination.limit=t,this.loadData()},changePage:function(t){this.pagination.page=t,this.loadData()},loadData:function(){var t=this,e=this.filter,a=e.id,l=e.name,s=e.phone,i=e.date,r=e.status,n=e.express,o=this.pagination,c=o.limit,p=o.page;this.isLoaded=!1,this.$http.get("/api/orders",{params:{limit:c,page:p,id:a,name:l,phone:s,status:r,express:n,start:i&&i[0],end:i&&i[1]}}).then(function(e){var a=e.data;t.isLoaded=!0,t.pagination.total=a.total,t.orders=a.orders})},chooseFile:function(t){this.file=t.target.files?t.target.files[0]:null},uploadFile:function(){var t=this,e=new FileReader;this.isImported=!1,e.onload=function(e){var a=r.a.read(e.target.result,{type:"binary",cellDates:!0,cellStyles:!0}),l=r.a.utils.sheet_to_json(a.Sheets[a.SheetNames[0]]);t.$http.post("/api/orders/upload",{orders:l}).then(function(){t.isImported=!0,t.file=null,t.$refs.upload.value=null,t.clearFilter(),t.$notify({title:"导入成功",message:"订单导入成功，已自动刷新列表",type:"success"})}).catch(function(){t.$notify({title:"导入失败",message:"订单导入失败，请重试",type:"error"})})},e.readAsBinaryString(this.file)},markOrder:function(t){var e=this,a=t._id;this.isMarked=!1,this.markTarget=t,this.$http.get("/api/orders/".concat(a,"/status")).then(function(t){var a=t.data;e.isMarked=!0,e.showMark=!0,e.markType={trouble:a.trouble,return:a.return,profit:a.profit}})},changeMark:function(t,e){var a=this,l=this.markTarget._id;this.isMarked=!1,this.$http.post("/api/orders/".concat(l,"/").concat(e),{isActive:t}).then(function(){a.isMarked=!0})},showOrder:function(t){this.showDetail=!0,this.orderDetail=Object.keys(t).map(function(e){return{key:e,value:t[e]}})},deleteOrder:function(t){var e=this;this.$confirm("确定将此订单删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t._id;e.$http.delete("/api/orders/".concat(a)).then(function(){e.loadData(),e.$notify({title:"删除成功",message:"订单删除成功，已自动刷新列表",type:"success"})}).catch(function(){e.$notify({title:"删除失败",message:"订单删除失败，请重试",type:"error"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}}},o=n,c=a("2877"),p=Object(c["a"])(o,l,s,!1,null,null,null);p.options.__file="index.vue";e["default"]=p.exports}}]);
//# sourceMappingURL=index.7868758c.js.map