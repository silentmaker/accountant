(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["js/tool"],{"02f4":function(t,e,a){var s=a("4588"),n=a("be13");t.exports=function(t){return function(e,a){var i,r,l=String(n(e)),o=s(a),c=l.length;return o<0||o>=c?t?"":void 0:(i=l.charCodeAt(o),i<55296||i>56319||o+1===c||(r=l.charCodeAt(o+1))<56320||r>57343?t?l.charAt(o):i:t?l.slice(o,o+2):r-56320+(i-55296<<10)+65536)}}},"5df3":function(t,e,a){"use strict";var s=a("02f4")(!0);a("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,a=this._i;return a>=e.length?{value:void 0,done:!0}:(t=s(e,a),this._i+=t.length,{value:t,done:!1})})},a6c3:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"dashboard-content"},[a("div",{staticClass:"form-section"},[a("div",{staticClass:"section-title"},[t._v("发货关联运单号")]),a("div",{staticClass:"mt-m"},[a("span",{staticClass:"label",attrs:{type:"text"}},[t._v("1. 选择发货平台: ")]),a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.targetType,callback:function(e){t.targetType=e},expression:"targetType"}},t._l(t.targetOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),a("div",{staticClass:"mt-m"},[a("span",{staticClass:"label",attrs:{type:"text"}},[t._v("2. 上传订单表: ")]),a("el-button",{attrs:{size:"small"},on:{click:function(e){t.$refs.uploadTarget.click()}}},[t._v("选择文件")]),t.target?a("span",{staticClass:"remark"},[t._v(t._s(t.target.name))]):t._e()],1),a("div",{staticClass:"mt-m"},[a("span",{staticClass:"label",attrs:{type:"text"}},[t._v("3. 选择快递公司: ")]),a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),a("div",{staticClass:"mt-m"},[a("span",{staticClass:"label",attrs:{type:"text"}},[t._v("4. 上传快递单号表: ")]),a("el-button",{attrs:{size:"small"},on:{click:function(e){t.$refs.uploadSource.click()}}},[t._v("选择文件")]),t.source?a("span",{staticClass:"remark"},[t._v(t._s(t.source.name))]):t._e()],1),a("div",{staticClass:"mt-l"},[a("el-button",{attrs:{size:"small",type:"primary",disabled:t.disabled},on:{click:t.mergeFile}},[t._v("确认合并")]),a("span",{staticClass:"remark"},[t._v("在发货表里找不到运单号的订单，快递公司会变成未知，快递单号会变成空")])],1),a("input",{ref:"uploadSource",attrs:{type:"file"},on:{change:t.chooseSource}}),a("input",{ref:"uploadTarget",attrs:{type:"file"},on:{change:t.chooseTarget}})]),a("div",{staticClass:"form-section"},[a("div",{staticClass:"section-title mb-m"},[t._v("常用平台帐号")]),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-view",plain:""},on:{click:t.gotoDoc}},[t._v("查看文档")])],1)])},n=[],i=(a("ac6a"),a("5df3"),a("20d6"),a("cadf"),a("551c"),a("097d"),a("1146")),r=a.n(i),l={luban:["订单编号","物流公司","运单号","售后地址"],fengye:["订单ID","页面名称","套餐明细","数量","套餐单价","总价","姓名","手机号码","省","市","地区","收件地址","下单IP","下单时间","订单状态","快递公司","快递单号","留言","备注","详情页URL","广告id","广告名称","投放账户","身份证"]},o={name:"Tool",data:function(){return{source:null,sourceType:"debang",sourceOption:[{label:"德邦物流",value:"debang"},{label:"韵达快递",value:"yunda"}],sourceList:[],target:null,targetType:"fengye",targetOption:[{label:"枫页",value:"fengye"},{label:"鲁班",value:"luban"}],targetList:[]}},computed:{disabled:function(){return!this.source||!this.target},sourceName:function(){var t=this,e=this.sourceOption.findIndex(function(e){return e.value===t.sourceType});return this.sourceOption[e].label}},methods:{chooseSource:function(t){this.source=t.target.files?t.target.files[0]:null},chooseTarget:function(t){this.target=t.target.files?t.target.files[0]:null},encryptNubmer:function(t){return"".concat(t.substr(0,4),"*****").concat(t.substr(9))},readFile:function(t){var e=this;return new Promise(function(a){var s=new FileReader;s.onload=function(s){var n=r.a.read(s.target.result,{type:"binary",codepage:936,cellDates:!0,cellStyles:!0}),i=r.a.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]);e["".concat(t,"List")]=i,a()},s.readAsBinaryString(e[t])})},mergeFile:function(){var t=this;Promise.all([this.readFile("source"),this.readFile("target")]).then(function(){t.targetList.forEach(function(e){var a=t.sourceList.findIndex(function(a){return"fengye"===t.targetType?"debang"===t.sourceType?a["收件人姓名"]===e["姓名"]&&a["收件人手机"]===t.encryptNubmer(e["手机号码"]):a["订单号"].trim()===e["订单ID"]:"debang"===t.sourceType?a["平台/用户订单号"]===e["订单编号"]:a["订单号"].trim()===e["订单编号"]});if("fengye"===t.targetType)e["快递单号"]=-1!==a?"".concat(t.sourceList[a]["运单号"]):"",e["快递公司"]=-1!==a?t.sourceName:"未知";else{var s="debang"===t.sourceType?"debangwuliu":"yundakuaidi";e["物流公司"]=-1!==a?s:"",e["运单号"]=-1!==a?"".concat(t.sourceList[a]["运单号"]):""}});var e=r.a.utils.json_to_sheet(t.targetList,{header:l["".concat(t.targetType)]}),a=r.a.utils.book_new();r.a.utils.book_append_sheet(a,e,"Sheet1"),r.a.writeFile(a,"发货关联运单号列表.xls")})},gotoDoc:function(){window.open("https://docs.qq.com/sheet/DYWZTdVRSS3BIam1U")}}},c=o,u=a("2877"),d=Object(u["a"])(c,s,n,!1,null,null,null);d.options.__file="tool.vue";e["default"]=d.exports}}]);
//# sourceMappingURL=tool.fe963832.js.map